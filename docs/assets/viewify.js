(function(a){function b(c){this.up=1,this.down=-1,this.data=c.data,this.listener=c.listener,this.elements=c.elements||[],this.endPercent=c.endPercent||0.6,this.startPercent=c.startPercent||0.4,this.container=c.container||document.body}return b.prototype.dev=function(){this.changePointElement=document.createElement('div'),this.changePointElement.setAttribute('style','left: 0;top: 0;width: 100%;height: 3px;z-index: 10000;background: red;position: absolute;'),this.container.appendChild(this.changePointElement)},b.prototype.round=function(c,d){return+(Math.round(c+'e'+d)+'e-'+d)},b.prototype.scroll=function(){var c,d,e,f,g=a.scrollY<=this.position?this.startPercent:this.endPercent,h=a.scrollY+a.innerHeight*g;this.changePointElement&&(this.changePointElement.style.top=h+'px');for(var j=0,k=this.elements.length;j<k;j++)if(c=this.elements[j],d=c.offsetTop,e=c.offsetHeight,f=d+e,j===k-1&&(f=this.container.offsetHeight),this.position=a.scrollY,h>=d&&h<=f&&this.current!==j)return this.current=j,this.listener(c,j,h);this.position=a.scrollY},b.prototype.listen=function(c){this.animation&&a.cancelAnimationFrame(this.animation),this.event&&a.removeEventListener(this.event),this.listener=this.listener||c,this.animation=a.requestAnimationFrame.bind(null,this.scroll.bind(this)),this.event=a.addEventListener('scroll',this.animation),this.animation()},a.Viewify=b})(this);