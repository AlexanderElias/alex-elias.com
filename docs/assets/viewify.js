(function(a){function b(a){this.up=1,this.down=-1,this.data=a.data,this.listener=a.listener,this.elements=a.elements||[],this.endPercent=a.endPercent||0.6,this.startPercent=a.startPercent||0.4,this.container=a.container||document.body}return b.prototype.dev=function(){this.changePointElement=document.createElement('div'),this.changePointElement.setAttribute('style','left: 0;top: 0;width: 100%;height: 3px;z-index: 10000;background: red;position: absolute;'),this.container.appendChild(this.changePointElement)},b.prototype.round=function(a,b){return+(Math.round(a+'e'+b)+'e-'+b)},b.prototype.scroll=function(){var b,c,d,e,f=a.scrollY<=this.position?this.startPercent:this.endPercent,g=a.scrollY+a.innerHeight*f;this.changePointElement&&(this.changePointElement.style.top=g+'px');for(var h=0,i=this.elements.length;h<i;h++)if(b=this.elements[h],c=b.offsetTop,d=b.offsetHeight,e=c+d,h===i-1&&(e=this.container.offsetHeight),this.position=a.scrollY,g>=c&&g<=e&&this.current!==h)return this.current=h,this.listener(b,h,g);this.position=a.scrollY},b.prototype.listen=function(b){this.animation&&a.cancelAnimationFrame(this.animation),this.event&&a.removeEventListener(this.event),this.listener=this.listener||b,this.animation=a.requestAnimationFrame.bind(null,this.scroll.bind(this)),this.event=a.addEventListener('scroll',this.animation),a.requestAnimationFrame(this.animation.bind(this))},a.Viewify=b})(this);